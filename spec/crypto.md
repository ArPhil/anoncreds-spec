## Cryptographic protocols

### Terminology

_TODO: general terms here_

### Protocols

#### ProveCL

`ProveCL` is used by a Holder who possesses one or more signatures from one or more Issuers and uses them to derive a proof of knowledge for them. The algorithm is invoked once per signature.

_TODO: considerations about the algorithm, security and implementation_

```
 = ProveCL(PK, signature, (m_1,..., m_L), RevealedIndexes)

Inputs:

 - PK (REQUIRED), the public key of the issuer
 - signature (REQUIRED), a signature generated by the issuer
 - (m_1,..., m_L) (OPTIONAL), the set of signed messages
 - RevealedIndexes (OPTIONAL), indices of revealed messages

Parameters:

 - TBD

Definitions:

 - l_n, the bitlength of the RSA modulus n of the issuer public key
 - l_m, the bitlength of messages
 - l_e, the bitlength of the prime e
 - l_v, the bitlength of the randomization factor v
 - l'_e, the size of the interval in which e is chosen
 - l_0, security parameter that governs the statistical zero-knowledge property
 - l_H, the bitsize of values hashed by the hash function H used for the Fiat-Shamir heuristic
 - L, the number of messages signed by the issuer

Outputs:

 - TBD

Procedure:

 1. (i1, i2,..., iR) = RevealedIndexes       # the indices of messages that are revealed in this proof

 2. (j1, j2,..., jU) = [L] \ RevealedIndexes # the indices of messages that are kept hidden

 3. (n, S, Z, R_1, ..., R_L) = PK            # unpack the issuer public key

 4. (A, e, v) = signature                    # unpack the signature

 5. r = PRNG(l_n + l_0)                      # choose random to blind the signature

 6. A' = A * S^r mod n                       # compute the randomised signature

 7. v' = v - e * r                           # recompute v given the randomisation

 8. e' = e - 2^{l_e - 1}                     # prepare value to prove that e is positive

 9. e~ = PRNG(l'_e + l_0 + l_H)              # random for t-value of the signature

10. v~ = PRNG(l_v + l_0 + l_H)               # random for t-value of the signature

11. foreach j in (j1, j2,..., jU):

12.     m~_j = PRNG(l_m + l_0 + l_H)         # random for t-value of the signature

13. Z~ = A'^{e~} * S^{v~}                    # compute t-value for the signature

14. foreach j in (j1, j2,..., jU):

15.     Z~ = Z~ * R_j^{m~_j}                 # compute t-value for the signature

16. TBD - c-values (?)
```
